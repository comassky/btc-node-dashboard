# üê≥ Docker Guide

This document explains how to build, run, and configure the Bitcoin Node Dashboard using Docker.

## Pre-built Images


Official images are available on GitHub Packages:
https://github.com/comassky/btc-node-dashboard/pkgs/container/btc-node-dashboard

---

**CI Note:** GitHub Actions workflows use `pnpm` to install frontend dependencies before building Docker images. See `.github/workflows/docker.yml`, `docker-native.yml` and `docker-dev-native.yml`.


### Run Native Image (Recommended)

```bash
docker run -d -p 8080:8080 \
  -e BITCOIN_RPC_HOST=<HOST> \
  -e BITCOIN_RPC_PORT=<PORT> \
  -e BITCOIN_RPC_USER=<USER> \
  -e BITCOIN_RPC_PASSWORD=<PASSWORD> \
  -e WS_POLLING_INTERVAL=5 \
  -e MIN_OUTBOUND_PEERS=8 \
  -e LOG_LEVEL=INFO \
  -e DASHBOARD_CACHE_VALIDITY_BUFFER_MS=200 \
  ghcr.io/comassky/btc-node-dashboard:latest
```



## Docker Compose

See [compose.yml](compose.yml) for a full setup with Bitcoin Core.

## Configuration

### Environment Variables

| Variable                             | Default     | Description                                                                                                           |
| ------------------------------------ | ----------- | --------------------------------------------------------------------------------------------------------------------- |
| `BITCOIN_RPC_HOST`                   | `127.0.0.1` | Bitcoin node hostname or IP address                                                                                   |
| `QUARKUS_IO_THREADS`                 | `8`         | Number of IO threads for backend concurrency (recommended: 2 √ó number of CPU cores). Example: `QUARKUS_IO_THREADS=16` |
| `BITCOIN_RPC_PORT`                   | `8332`      | Bitcoin RPC port                                                                                                      |
| `BITCOIN_RPC_USER`                   | -           | RPC username for authentication                                                                                       |
| `BITCOIN_RPC_PASSWORD`               | -           | RPC password for authentication                                                                                       |
| `BITCOIN_RPC_SCHEME`                 | `http`      | RPC protocol (`http` or `https`)                                                                                      |
| `WS_POLLING_INTERVAL`                | `5`         | Dashboard polling interval in seconds                                                                                 |
| `MIN_OUTBOUND_PEERS`                 | `8`         | Minimum number of outbound peers for dashboard health                                                                 |
| `DASHBOARD_CACHE_VALIDITY_BUFFER_MS` | `200`       | Cache validity buffer in ms for dashboard cache                                                                       |
| `DASHBOARD_SESSIONS_MAX`             | `1000`      | Maximum number of dashboard sessions                                                                                  |
| `DASHBOARD_CACHE_MAX_ITEMS`          | `50`        | Maximum number of items in dashboard cache                                                                            |
| `DASHBOARD_DISABLE_MEMPOOL`          | `false`     | Set to `true` to disable mempool info retrieval in the dashboard                                                      |
| `LOG_LEVEL`                          | `INFO`      | Application log level (`TRACE`, `DEBUG`, `INFO`, `WARN`, `ERROR`). Use `DEBUG` to see detailed startup configuration  |

### Application Properties

As an alternative to environment variables, create `src/main/resources/application-local.properties`:

```properties
bitcoin.rpc.scheme=http
bitcoin.rpc.host=localhost
bitcoin.rpc.port=8332
bitcoin.rpc.user=your_rpc_username
bitcoin.rpc.password=your_rpc_password
dashboard.polling.interval.seconds=5
dashboard.cache.validity.buffer.ms=200
```



## Available Image Tags

Images are published automatically by the GitHub Actions native workflows:
- `docker-native.yml` (Native, tags: `latest`, `<version>`, `main`)
- `docker-dev-native.yml` (develop branch, tag: `develop`)

Examples:

```bash
docker pull ghcr.io/comassky/btc-node-dashboard:1.5.0-SNAPSHOT
docker pull ghcr.io/comassky/btc-node-dashboard:develop
```


Notes:

- Tags are generated by the GitHub Actions `docker/metadata-action` configuration inside `.github/workflows/`.
- Native (GraalVM) images are produced by `docker-native.yml` and `docker-dev-native.yml`; the develop workflow adds a `develop` tag while the main workflow produces `latest` and semver tags when building from git tags.
