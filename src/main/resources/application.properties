# Bitcoin RPC Configuration
bitcoin.rpc.host=${RPC_HOST}
bitcoin.rpc.port=${RPC_PORT}
bitcoin.rpc.user=${RPC_USER}
bitcoin.rpc.password=${RPC_PASS}
bitcoin.rpc.scheme=http

# Dashboard Configuration (dot-case only, see DashboardConfig.java)
dashboard.polling.interval.seconds=${WS_POLLING_INTERVAL:5}
dashboard.peers.min.outbound=${MIN_OUTBOUND_PEERS:8}
dashboard.mempool.disable=${DASHBOARD_DISABLE_MEMPOOL:false}
dashboard.sessions.max=${DASHBOARD_SESSIONS_MAX:1000}
dashboard.cache.validity.buffer.ms=${DASHBOARD_CACHE_VALIDITY_BUFFER_MS:100}
dashboard.cache.max.items=${DASHBOARD_CACHE_MAX_ITEMS:1}

quarkus.tls.trust-all=true
quarkus.banner.path=banner.txt

# ==================================
# OpenAPI Configuration
# ==================================
# Generate OpenAPI spec at build time in project root (versioned file)
quarkus.smallrye-openapi.store-schema-directory=.
quarkus.smallrye-openapi.open-api-version=3.0.3
quarkus.swagger-ui.always-include=false
quarkus.smallrye-openapi.path=/q/openapi
mp.openapi.extensions.smallrye.info.title=Bitcoin Node Dashboard API
mp.openapi.extensions.smallrye.info.version=1.5.0
mp.openapi.extensions.smallrye.info.description=Real-time Bitcoin Core node monitoring dashboard with WebSocket support
mp.openapi.extensions.smallrye.info.contact.name=Bitcoin Dashboard Support
mp.openapi.extensions.smallrye.info.license.name=MIT License

# Logging Configuration
quarkus.log.level=${LOG_LEVEL:INFO}
quarkus.log.console.level=${LOG_LEVEL:INFO}

# HTTP Client optimizations for RPC calls
quarkus.rest-client.read-timeout=8000
## Number of IO threads (recommended: 2 x number of CPU cores)
# Set via the QUARKUS_IO_THREADS environment variable, or defaults to 8 if not set.
# Example: QUARKUS_IO_THREADS=16 java -jar ...
quarkus.http.io-threads=${QUARKUS_IO_THREADS:8}

# REST client connection pool (increases concurrency for RPC calls)
quarkus.rest-client.connection-pool-size=64
quarkus.rest-client.max-redirects=3
quarkus.rest-client.follow-redirects=true

# GraalVM Native Image optimizations
quarkus.native.enable-reports=true
quarkus.native.compression.level=10

# Profile-Guided Optimization (PGO) - uncomment after collecting profiles
# quarkus.native.additional-build-args=--pgo-instrument
# After running and collecting default.iprof, rebuild with:
# quarkus.native.additional-build-args=--pgo=default.iprof

# ==================================
# Compression
# ==================================
quarkus.http.enable-compression=true
quarkus.http.static-resources.caching-enabled=true
quarkus.http.compressors=deflate,gzip,br

# ==================================
# Performance Optimizations
# ==================================
# Enable HTTP/2 for better performance
quarkus.http.http2=true

# Optimize buffer sizes
quarkus.http.limits.max-body-size=10M
quarkus.http.body.handle-file-uploads=true
quarkus.http.body.uploads-directory=${java.io.tmpdir}/quarkus-uploads

# Optimize worker thread pool
quarkus.thread-pool.core-threads=4
quarkus.thread-pool.max-threads=32
quarkus.thread-pool.queue-size=256
quarkus.thread-pool.growth-resistance=0

# Optimize Vert.x event loop
quarkus.vertx.prefer-native-transport=true
quarkus.vertx.warning-exception-time=10s

# Optimize Jackson serialization
quarkus.jackson.fail-on-unknown-properties=false
quarkus.jackson.write-dates-as-timestamps=false

# Reduce Jackson memory footprint
quarkus.jackson.serialization-inclusion=non-null

# Native image optimizations (for native builds)
quarkus.native.resources.includes=banner.txt,application*.properties
quarkus.native.additional-build-args=--gc=serial,--initialize-at-run-time=io.netty,-H:+RemoveUnusedSymbols,-H:-UseContainerSupport

# ==================================
# Memory & GC Optimizations
# ==================================
# Limit direct memory allocation
quarkus.vertx.max-worker-execute-time=60s
quarkus.vertx.max-event-loop-execute-time=10s

# Enable access logging only for errors (reduce memory from logging buffers)
quarkus.http.access-log.enabled=false

# ==================================
# WebSocket Optimizations
# ==================================
quarkus.websocket.max-frame-size=65536
quarkus.websocket.dispatch-to-worker=false
